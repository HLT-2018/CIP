章岳—前馈神经网络

### 目录结构
```
├─README.md
├─src
|  ├─bpnn_model.py： 神经网络模型类
|  ├─Config.py ：配置文件
|  ├─corpus.py：语料类
|  ├─data_loader.py：数据载入器类
|  ├─data_set.py：数据集类
|  ├─run.py：运行文件
|  ├─utils.py：工具类
|  └word2vec.py：词嵌入类
├─data
|  ├─dev.conll：小开发集
|  └train.conll：小训练集
├─corpus
|   ├─giga.100.txt：词向量文件
|   └giga.chars.100.txt：字向量文件
├─bigdata
|    ├─dev：大开发集
|    ├─test：大测试集
|    └train：大训练集
```

### 运行方式

#### 环境

Python3.8

#### 命令

```shell
cd ./src
python3 run.py
```

### 超参数选择

| 参数名称       | 用处                                                  | 默认取值 |
| -------------- | ----------------------------------------------------- | -------- |
| epoch          | 训练最大轮数                                          | 50       |
| exitor         | 退出轮数（多少轮无提升                                | 10       |
| random_seed    | 随机种子                                              | 0        |
| shuffle        | 是否打乱数据集                                        | True     |
| batch_size     | 多少个样本更新一次权重（设为1则Mini-BGD退化为SGD）    | 32       |
| lmbda          | L2正则化系数（不需要正则化则设置为0）                 | 0.01     |
| learning_rate  | 学习率                                                | 0.5      |
| decay_rate     | 学习率衰减速率（用于模拟退火，不需要模拟退火设置为1） | 0.96     |
| window         | 上下文窗口大小                                        | 5        |
| activation     | 隐藏层激活函数选择                                    | ReLU     |
| word_embed_dim | 词向量维度                                            | 100      |
| char_embed_dim | 字向量维度                                            | 100      |
| layer_sizes    | 隐藏层神经元维度                                      | 300      |

### 运行结果

#### 1. 小数据集 + 正则化 + 模拟退火 + shuffle + ReLU（正确率：88.9704%）

```
打乱数据集...
##########开始训练##########
初始化词向量矩阵完成！当前词向量矩阵共有372850个词，词向量维度为100
通过数据集“train.conll”为词向量矩阵新增625个未登录词，当前词向量矩阵中共有373475个词！
数据集：train.conll，句子数：803，词数：4537，词性数目：31
数据集：dev.conll，句子数：1910，词数：8577，词性数目：30

train.conll数据集载入完成！样本规模：20454
正在打乱：train.conll...
正在划分batch：train.conll，batch大小：32...
dev.conll数据集载入完成！样本规模：50319
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19042个词的词性，正确率为:0.930967
开发集共有50319个词，预测正确了43533个词的词性，正确率为:0.865140

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19812个词的词性，正确率为:0.968612
开发集共有50319个词，预测正确了44183个词的词性，正确率为:0.878058

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20195个词的词性，正确率为:0.987337
开发集共有50319个词，预测正确了44504个词的词性，正确率为:0.884437

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20321个词的词性，正确率为:0.993498
开发集共有50319个词，预测正确了44534个词的词性，正确率为:0.885033

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20378个词的词性，正确率为:0.996284
开发集共有50319个词，预测正确了44538个词的词性，正确率为:0.885113

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20428个词的词性，正确率为:0.998729
开发集共有50319个词，预测正确了44658个词的词性，正确率为:0.887498

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20444个词的词性，正确率为:0.999511
开发集共有50319个词，预测正确了44690个词的词性，正确率为:0.888134

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20450个词的词性，正确率为:0.999804
开发集共有50319个词，预测正确了44715个词的词性，正确率为:0.888631

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20451个词的词性，正确率为:0.999853
开发集共有50319个词，预测正确了44735个词的词性，正确率为:0.889028

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20452个词的词性，正确率为:0.999902
开发集共有50319个词，预测正确了44739个词的词性，正确率为:0.889107

第11轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44742个词的词性，正确率为:0.889167

第12轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44744个词的词性，正确率为:0.889207

第13轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44754个词的词性，正确率为:0.889406

第14轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44758个词的词性，正确率为:0.889485

第15轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44763个词的词性，正确率为:0.889584

第16轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44762个词的词性，正确率为:0.889565

第17轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44767个词的词性，正确率为:0.889664

第18轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44762个词的词性，正确率为:0.889565

第19轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44762个词的词性，正确率为:0.889565

第20轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44759个词的词性，正确率为:0.889505

第21轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44760个词的词性，正确率为:0.889525

第22轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44758个词的词性，正确率为:0.889485

第23轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44763个词的词性，正确率为:0.889584

第24轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44760个词的词性，正确率为:0.889525

第25轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44764个词的词性，正确率为:0.889604

第26轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44769个词的词性，正确率为:0.889704

第27轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44763个词的词性，正确率为:0.889584

第28轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44758个词的词性，正确率为:0.889485

第29轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44762个词的词性，正确率为:0.889565

第30轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44761个词的词性，正确率为:0.889545

第31轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44764个词的词性，正确率为:0.889604

第32轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44763个词的词性，正确率为:0.889584

第33轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44766个词的词性，正确率为:0.889644

第34轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44768个词的词性，正确率为:0.889684

第35轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44766个词的词性，正确率为:0.889644

第36轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44763个词的词性，正确率为:0.889584
经过10轮模型正确率无提升，结束训练！最大正确率为第26轮训练后的0.889704
用时:0:11:39.822983
```

PS：大数据集会在服务器上跑一下，日后补上
