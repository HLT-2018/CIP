##  章岳—对数线性模型

### 目录结构
```
├─README.md
├─src
|  ├─Config.py：配置文件
|  ├─data_loader.py：数组读取类文件
|  ├─log_linear_model.py：对数线性模型类文件
|  ├─run.py：运行文件
├─data
|  ├─dev.conll
|  └train.conll
├─bigdata
|    ├─dev
|    ├─test
|    └train
```

### 运行方式

#### 环境

Python3.8

#### 命令

```shell
cd ./src
python3 run.py
```

### 超参数选择

| 超参数名称    | 用处                                                  | 默认取值 |
| ------------- | ----------------------------------------------------- | -------- |
| epoch         | 训练最大轮数                                          | 50       |
| exitor        | 退出轮数（多少轮无提升）                              | 5        |
| random_seed   | 随机种子                                              | 0        |
| shuffle       | 是否打乱数据集                                        | True     |
| batch_size    | 多少个样本更新一次权重                                | 32       |
| lmbda         | L2正则化系数（不需要正则化则设置为0）                 | 0.01     |
| learning_rate | 学习率                                                | 0.3      |
| decay_rate    | 学习率衰减速率（用于模拟退火，不需要模拟退火设置为1） | 0.96     |

### 运行结果

#### 1. 小数据集 + 正则化 + 模拟退火 + shuffle（87.45%）

```
打乱数据集...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67359(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19838个词的词性，正确率为:0.969884
开发集共有50319个词，预测正确了43133个词的词性，正确率为:0.857191

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20205个词的词性，正确率为:0.987826
开发集共有50319个词，预测正确了43561个词的词性，正确率为:0.865697

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20330个词的词性，正确率为:0.993938
开发集共有50319个词，预测正确了43710个词的词性，正确率为:0.868658

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20400个词的词性，正确率为:0.997360
开发集共有50319个词，预测正确了43815个词的词性，正确率为:0.870745

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20429个词的词性，正确率为:0.998778
开发集共有50319个词，预测正确了43896个词的词性，正确率为:0.872354

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20442个词的词性，正确率为:0.999413
开发集共有50319个词，预测正确了43955个词的词性，正确率为:0.873527

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20451个词的词性，正确率为:0.999853
开发集共有50319个词，预测正确了43980个词的词性，正确率为:0.874024

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43989个词的词性，正确率为:0.874203

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44006个词的词性，正确率为:0.874540

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43999个词的词性，正确率为:0.874401

第11轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了44005个词的词性，正确率为:0.874521

第12轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43993个词的词性，正确率为:0.874282

第13轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43989个词的词性，正确率为:0.874203

第14轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43981个词的词性，正确率为:0.874044
经过5轮模型正确率无提升，结束训练！最大正确率为第9轮训练后的0.874540
用时:0:01:33.099777
```

PS：大数据集会在服务器上跑一下，日后补上

### 几个易错点

+ 如果需要对数据集进行shuffle，那么注意本问题中的样本是词而非句子，应该打乱词。（但对于global linear model等序列标注问题则是打乱句子）
+ 对学习率进行模拟退火时，学习率本身不需要重新赋值，否则会很快下降到接近于0

### 学习过程中的笔记和思考

[NLP自学笔记：线性模型和对数线性模型](https://hillzhang1999.gitee.io/2020/03/17/nlp-zi-xue-bi-ji-xian-xing-mo-xing-he-dui-shu-xian-xing-mo-xing/)

### 参考资料（部分）

- [苏州大学李正华老师的课件](http://hlt.suda.edu.cn/~zhli/teach/cip-2015-fall/)
- 李航老师《统计学习方法》的第六章
- Andrew Ng的机器学习课程
- Andrew Ng的深度学习课程
