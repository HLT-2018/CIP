##  章岳—对数线性模型

### 目录结构
```
├─README.md
├─src
|  ├─Config.py：配置文件
|  ├─data_loader.py：数组读取类文件
|  ├─log_linear_model.py：对数线性模型类文件
|  ├─run.py：运行文件
├─data
|  ├─dev.conll
|  └train.conll
├─bigdata
|    ├─dev
|    ├─test
|    └train
```

### 运行方式

#### 环境

Python3.8

#### 命令

```shell
cd ./src
python3 run.py
```

### 超参数选择

| 超参数名称    | 用处                                                  | 默认取值 |
| ------------- | ----------------------------------------------------- | -------- |
| epoch         | 训练最大轮数                                          | 50       |
| exitor        | 退出轮数（多少轮无提升）                              | 5        |
| random_seed   | 随机种子                                              | 0        |
| shuffle       | 是否打乱数据集                                        | True     |
| batch_size    | 多少个样本更新一次权重                                | 32       |
| lmbda         | L2正则化系数（不需要正则化则设置为0）                 | 0.01     |
| learning_rate | 学习率                                                | 0.3      |
| decay_rate    | 学习率衰减速率（用于模拟退火，不需要模拟退火设置为1） | 0.96     |

### 运行结果

#### 1. 小数据集 + 正则化 + 模拟退火 + shuffle

```
打乱数据集...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67359(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了17327个词的词性，正确率为:0.847120
开发集共有50319个词，预测正确了38994个词的词性，正确率为:0.774936

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了18091个词的词性，正确率为:0.884472
开发集共有50319个词，预测正确了40488个词的词性，正确率为:0.804626

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了18515个词的词性，正确率为:0.905202
开发集共有50319个词，预测正确了41370个词的词性，正确率为:0.822155

.........

第40轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20237个词的词性，正确率为:0.989391
开发集共有50319个词，预测正确了43638个词的词性，正确率为:0.867227

第41轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20246个词的词性，正确率为:0.989831
开发集共有50319个词，预测正确了43644个词的词性，正确率为:0.867346

第42轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20254个词的词性，正确率为:0.990222
开发集共有50319个词，预测正确了43649个词的词性，正确率为:0.867446

第43轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20262个词的词性，正确率为:0.990613
开发集共有50319个词，预测正确了43656个词的词性，正确率为:0.867585

第44轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20271个词的词性，正确率为:0.991053
开发集共有50319个词，预测正确了43667个词的词性，正确率为:0.867803

第45轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20278个词的词性，正确率为:0.991395
开发集共有50319个词，预测正确了43671个词的词性，正确率为:0.867883

第46轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20286个词的词性，正确率为:0.991786
开发集共有50319个词，预测正确了43681个词的词性，正确率为:0.868082

第47轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20289个词的词性，正确率为:0.991933
开发集共有50319个词，预测正确了43680个词的词性，正确率为:0.868062

第48轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20293个词的词性，正确率为:0.992129
开发集共有50319个词，预测正确了43677个词的词性，正确率为:0.868002

第49轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20302个词的词性，正确率为:0.992569
开发集共有50319个词，预测正确了43675个词的词性，正确率为:0.867962

第50轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20305个词的词性，正确率为:0.992715
开发集共有50319个词，预测正确了43676个词的词性，正确率为:0.867982

最大正确率为第46轮训练后的0.868082!
用时:0:05:11.013286
```

PS：大数据集会在服务器上跑一下，日后补上

### 几个易错点

+ 如果需要对数据集进行shuffle，那么注意本问题中的样本是词而非句子，应该打乱词。（但对于global linear model等序列标注问题则是打乱句子）
+ 对学习率进行模拟退火时，学习率本身不需要重新赋值，否则会很快下降到接近于0

### 学习过程中的笔记和思考

[NLP自学笔记：线性模型和对数线性模型](https://hillzhang1999.gitee.io/2020/03/17/nlp-zi-xue-bi-ji-xian-xing-mo-xing-he-dui-shu-xian-xing-mo-xing/)

### 参考资料（部分）

- [苏州大学李正华老师的课件](http://hlt.suda.edu.cn/~zhli/teach/cip-2015-fall/)
- 李航老师《统计学习方法》的第六章
- Andrew Ng的机器学习课程
- Andrew Ng的深度学习课程