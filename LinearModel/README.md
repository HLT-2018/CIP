##  章岳—线性模型

### 目录结构
```
├─README.md
├─src
|  ├─Config.py：配置文件
|  ├─data_loader.py：数据载入文件
|  ├─linear_model.py：线性模型文件
|  └run.py：运行命令文件
├─data
|  ├─dev.conll
|  └train.conll
├─bigdata
|    ├─dev
|    ├─test
|    └train

```

### 运行方式

#### 环境

Python3.8

#### 命令

```shell
cd ./src
python3 run.py
```

### 超参数选择

| 超参数名称         | 用处                     | 默认取值 |
| ------------------ | ------------------------ | -------- |
| epoch              | 训练最大轮数             | 30       |
| exitor             | 退出轮数（多少轮无提升） | 5        |
| averaged_percetron | 是否使用 v 权重          | True     |
| shuffle            | 是否打乱数据集           | True     |

### 运行结果

#### 1. 小数据集+w权重+shuffle

```
打乱数据集...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67359(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了18867个词的词性，正确率为:0.922411
开发集共有50319个词，预测正确了40819个词的词性，正确率为:0.811205

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19787个词的词性，正确率为:0.967390
开发集共有50319个词，预测正确了42098个词的词性，正确率为:0.836622

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20153个词的词性，正确率为:0.985284
开发集共有50319个词，预测正确了42723个词的词性，正确率为:0.849043

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20268个词的词性，正确率为:0.990906
开发集共有50319个词，预测正确了42741个词的词性，正确率为:0.849401

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20329个词的词性，正确率为:0.993889
开发集共有50319个词，预测正确了42757个词的词性，正确率为:0.849719

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20369个词的词性，正确率为:0.995844
开发集共有50319个词，预测正确了42756个词的词性，正确率为:0.849699

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20414个词的词性，正确率为:0.998044
开发集共有50319个词，预测正确了42909个词的词性，正确率为:0.852740

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20418个词的词性，正确率为:0.998240
开发集共有50319个词，预测正确了42972个词的词性，正确率为:0.853992

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20430个词的词性，正确率为:0.998827
开发集共有50319个词，预测正确了42934个词的词性，正确率为:0.853236

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20444个词的词性，正确率为:0.999511
开发集共有50319个词，预测正确了43122个词的词性，正确率为:0.856973

第11轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20452个词的词性，正确率为:0.999902
开发集共有50319个词，预测正确了43121个词的词性，正确率为:0.856953

第12轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933

第13轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933

第14轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933

第15轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933
经过5轮模型正确率无提升，结束训练！最大正确率为第10轮训练后的0.856973
用时:0:00:50.999311
```

#### 2.小数据集+v权重+shuffle

```
打乱数据集...
使用累加权重...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67359(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19378个词的词性，正确率为:0.947394
开发集共有50319个词，预测正确了42171个词的词性，正确率为:0.838073

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19860个词的词性，正确率为:0.970959
开发集共有50319个词，预测正确了42769个词的词性，正确率为:0.849957

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20022个词的词性，正确率为:0.978879
开发集共有50319个词，预测正确了42922个词的词性，正确率为:0.852998

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20094个词的词性，正确率为:0.982400
开发集共有50319个词，预测正确了43035个词的词性，正确率为:0.855244

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20128个词的词性，正确率为:0.984062
开发集共有50319个词，预测正确了43062个词的词性，正确率为:0.855780

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20156个词的词性，正确率为:0.985431
开发集共有50319个词，预测正确了43085个词的词性，正确率为:0.856237

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20174个词的词性，正确率为:0.986311
开发集共有50319个词，预测正确了43102个词的词性，正确率为:0.856575

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20191个词的词性，正确率为:0.987142
开发集共有50319个词，预测正确了43132个词的词性，正确率为:0.857171

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20200个词的词性，正确率为:0.987582
开发集共有50319个词，预测正确了43147个词的词性，正确率为:0.857469

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20205个词的词性，正确率为:0.987826
开发集共有50319个词，预测正确了43155个词的词性，正确率为:0.857628

第11轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20206个词的词性，正确率为:0.987875
开发集共有50319个词，预测正确了43157个词的词性，正确率为:0.857668

第12轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20207个词的词性，正确率为:0.987924
开发集共有50319个词，预测正确了43162个词的词性，正确率为:0.857767

第13轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20207个词的词性，正确率为:0.987924
开发集共有50319个词，预测正确了43162个词的词性，正确率为:0.857767

第14轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20207个词的词性，正确率为:0.987924
开发集共有50319个词，预测正确了43162个词的词性，正确率为:0.857767

第15轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20207个词的词性，正确率为:0.987924
开发集共有50319个词，预测正确了43162个词的词性，正确率为:0.857767

第16轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20208个词的词性，正确率为:0.987973
开发集共有50319个词，预测正确了43163个词的词性，正确率为:0.857787

第17轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20208个词的词性，正确率为:0.987973
开发集共有50319个词，预测正确了43163个词的词性，正确率为:0.857787

第18轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20208个词的词性，正确率为:0.987973
开发集共有50319个词，预测正确了43163个词的词性，正确率为:0.857787

第19轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20208个词的词性，正确率为:0.987973
开发集共有50319个词，预测正确了43163个词的词性，正确率为:0.857787

第20轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20208个词的词性，正确率为:0.987973
开发集共有50319个词，预测正确了43163个词的词性，正确率为:0.857787

第21轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20208个词的词性，正确率为:0.987973
开发集共有50319个词，预测正确了43163个词的词性，正确率为:0.857787
经过5轮模型正确率无提升，结束训练！最大正确率为第16轮训练后的0.857787
用时:0:01:05.171202
```

PS：大数据集会在服务器上跑一下，日后补上

### 学习过程中的笔记和思考

[NLP自学笔记：线性模型和对数线性模型](https://hillzhang1999.gitee.io/2020/03/17/nlp-zi-xue-bi-ji-xian-xing-mo-xing-he-dui-shu-xian-xing-mo-xing/)

### 参考资料（部分）

- [苏州大学李正华老师的课件](http://hlt.suda.edu.cn/~zhli/teach/cip-2015-fall/)
- 李航老师《统计学习方法》的第六章
- Andrew Ng的机器学习课程
- Andrew Ng的深度学习课程