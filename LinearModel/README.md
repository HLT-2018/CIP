##  章岳—线性模型

### 目录结构
```
├─README.md
├─src
|  ├─Config.py：配置文件
|  ├─data_loader.py：数据载入文件
|  ├─linear_model.py：线性模型文件
|  └run.py：运行命令文件
├─data
|  ├─dev.conll
|  └train.conll
├─bigdata
|    ├─dev
|    ├─test
|    └train

```

### 运行方式

#### 环境

Python3.8

#### 命令

```shell
cd ./src
python3 run.py
```

### 超参数选择

| 超参数名称         | 用处                     | 默认取值 |
| ------------------ | ------------------------ | -------- |
| epoch              | 训练最大轮数             | 30       |
| exitor             | 退出轮数（多少轮无提升） | 5        |
| averaged_percetron | 是否使用 v 权重          | True     |
| shuffle            | 是否打乱数据集           | True     |

### 运行结果

#### 1. 小数据集+w权重+shuffle

```
打乱数据集...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67359(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了18867个词的词性，正确率为:0.922411
开发集共有50319个词，预测正确了40819个词的词性，正确率为:0.811205

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19787个词的词性，正确率为:0.967390
开发集共有50319个词，预测正确了42098个词的词性，正确率为:0.836622

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20153个词的词性，正确率为:0.985284
开发集共有50319个词，预测正确了42723个词的词性，正确率为:0.849043

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20268个词的词性，正确率为:0.990906
开发集共有50319个词，预测正确了42741个词的词性，正确率为:0.849401

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20329个词的词性，正确率为:0.993889
开发集共有50319个词，预测正确了42757个词的词性，正确率为:0.849719

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20369个词的词性，正确率为:0.995844
开发集共有50319个词，预测正确了42756个词的词性，正确率为:0.849699

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20414个词的词性，正确率为:0.998044
开发集共有50319个词，预测正确了42909个词的词性，正确率为:0.852740

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20418个词的词性，正确率为:0.998240
开发集共有50319个词，预测正确了42972个词的词性，正确率为:0.853992

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20430个词的词性，正确率为:0.998827
开发集共有50319个词，预测正确了42934个词的词性，正确率为:0.853236

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20444个词的词性，正确率为:0.999511
开发集共有50319个词，预测正确了43122个词的词性，正确率为:0.856973

第11轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20452个词的词性，正确率为:0.999902
开发集共有50319个词，预测正确了43121个词的词性，正确率为:0.856953

第12轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933

第13轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933

第14轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933

第15轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43120个词的词性，正确率为:0.856933
经过5轮模型正确率无提升，结束训练！最大正确率为第10轮训练后的0.856973
用时:0:00:50.999311
```

#### 2.小数据集+v权重+shuffle

```
打乱数据集...
使用累加权重...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67359(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19468个词的词性，正确率为:0.951794
开发集共有50319个词，预测正确了42148个词的词性，正确率为:0.837616

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20097个词的词性，正确率为:0.982546
开发集共有50319个词，预测正确了42837个词的词性，正确率为:0.851309

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20266个词的词性，正确率为:0.990809
开发集共有50319个词，预测正确了43199个词的词性，正确率为:0.858503

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20333个词的词性，正确率为:0.994084
开发集共有50319个词，预测正确了43259个词的词性，正确率为:0.859695

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20377个词的词性，正确率为:0.996235
开发集共有50319个词，预测正确了43297个词的词性，正确率为:0.860450

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20395个词的词性，正确率为:0.997115
开发集共有50319个词，预测正确了43291个词的词性，正确率为:0.860331

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20407个词的词性，正确率为:0.997702
开发集共有50319个词，预测正确了43258个词的词性，正确率为:0.859675

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20414个词的词性，正确率为:0.998044
开发集共有50319个词，预测正确了43233个词的词性，正确率为:0.859178

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20418个词的词性，正确率为:0.998240
开发集共有50319个词，预测正确了43212个词的词性，正确率为:0.858761

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20424个词的词性，正确率为:0.998533
开发集共有50319个词，预测正确了43192个词的词性，正确率为:0.858364
经过5轮模型正确率无提升，结束训练！最大正确率为第5轮训练后的0.860450
用时:0:00:31.537810
```

PS：大数据集会在服务器上跑一下，日后补上

### 学习过程中的笔记和思考

[NLP自学笔记：线性模型和对数线性模型](https://hillzhang1999.gitee.io/2020/03/17/nlp-zi-xue-bi-ji-xian-xing-mo-xing-he-dui-shu-xian-xing-mo-xing/)

### 参考资料（部分）

- [苏州大学李正华老师的课件](http://hlt.suda.edu.cn/~zhli/teach/cip-2015-fall/)
- 李航老师《统计学习方法》的第六章
- Andrew Ng的机器学习课程
- Andrew Ng的深度学习课程
