##  章岳—全局线性模型

### 目录结构
```
├─README.md
├─src
|  ├─Config.py：配置文件
|  ├─data_loader.py：数组读取类文件
|  ├─global_linear_model.py：全局线性模型类文件
|  ├─run.py：运行文件
├─data
|  ├─dev.conll
|  └train.conll
├─bigdata
|    ├─dev
|    ├─test
|    └train
```

### 运行方式

#### 环境

Python3.8

#### 命令

```shell
cd ./src
python3 run.py
```

### 超参数选择

| 超参数名称         | 用处                     | 默认取值 |
| ------------------ | ------------------------ | -------- |
| epoch              | 训练最大轮数             | 30       |
| exitor             | 退出轮数（多少轮无提升） | 5        |
| averaged_percetron | 是否使用 v 权重          | True     |
| shuffle            | 是否打乱数据集           | True     |

### 运行结果

#### 1. 小数据集+w权重+shuffle（正确率：87.1977%）

```
打乱数据集...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67391(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19156个词的词性，正确率为:0.936541
开发集共有50319个词，预测正确了41535个词的词性，正确率为:0.825434

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19697个词的词性，正确率为:0.962990
开发集共有50319个词，预测正确了42383个词的词性，正确率为:0.842286

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20150个词的词性，正确率为:0.985137
开发集共有50319个词，预测正确了43482个词的词性，正确率为:0.864127

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20283个词的词性，正确率为:0.991640
开发集共有50319个词，预测正确了43662个词的词性，正确率为:0.867704

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20307个词的词性，正确率为:0.992813
开发集共有50319个词，预测正确了43485个词的词性，正确率为:0.864186

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20353个词的词性，正确率为:0.995062
开发集共有50319个词，预测正确了43604个词的词性，正确率为:0.866551

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20361个词的词性，正确率为:0.995453
开发集共有50319个词，预测正确了43678个词的词性，正确率为:0.868022

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20410个词的词性，正确率为:0.997849
开发集共有50319个词，预测正确了43777个词的词性，正确率为:0.869989

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20431个词的词性，正确率为:0.998876
开发集共有50319个词，预测正确了43869个词的词性，正确率为:0.871818

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20441个词的词性，正确率为:0.999364
开发集共有50319个词，预测正确了43868个词的词性，正确率为:0.871798

第11轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20436个词的词性，正确率为:0.999120
开发集共有50319个词，预测正确了43823个词的词性，正确率为:0.870904

第12轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20441个词的词性，正确率为:0.999364
开发集共有50319个词，预测正确了43877个词的词性，正确率为:0.871977

第13轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20449个词的词性，正确率为:0.999756
开发集共有50319个词，预测正确了43745个词的词性，正确率为:0.869354

第14轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20453个词的词性，正确率为:0.999951
开发集共有50319个词，预测正确了43718个词的词性，正确率为:0.868817

第15轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43720个词的词性，正确率为:0.868857

第16轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43720个词的词性，正确率为:0.868857

第17轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20454个词的词性，正确率为:1.000000
开发集共有50319个词，预测正确了43720个词的词性，正确率为:0.868857
经过5轮模型正确率无提升，结束训练！最大正确率为第12轮训练后的0.871977
用时:0:02:02.907562
```

#### 2.小数据集+v权重+shuffle（正确率：88.0125%）

```
打乱数据集...
使用累加权重...
##########开始训练##########
数据集：train.conll，句子数：803，词数：20454，词性数目：31
数据集：dev.conll，句子数：1910，词数：50319，词性数目：30

特征空间维度：67391(部分特征数)*31(词性数)
第1轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了19524个词的词性，正确率为:0.954532
开发集共有50319个词，预测正确了42957个词的词性，正确率为:0.853693

第2轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20049个词的词性，正确率为:0.980199
开发集共有50319个词，预测正确了43718个词的词性，正确率为:0.868817

第3轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20217个词的词性，正确率为:0.988413
开发集共有50319个词，预测正确了43986个词的词性，正确率为:0.874143

第4轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20295个词的词性，正确率为:0.992226
开发集共有50319个词，预测正确了44096个词的词性，正确率为:0.876329

第5轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20336个词的词性，正确率为:0.994231
开发集共有50319个词，预测正确了44179个词的词性，正确率为:0.877978

第6轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20358个词的词性，正确率为:0.995307
开发集共有50319个词，预测正确了44210个词的词性，正确率为:0.878595

第7轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20373个词的词性，正确率为:0.996040
开发集共有50319个词，预测正确了44241个词的词性，正确率为:0.879211

第8轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20377个词的词性，正确率为:0.996235
开发集共有50319个词，预测正确了44241个词的词性，正确率为:0.879211

第9轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20383个词的词性，正确率为:0.996529
开发集共有50319个词，预测正确了44252个词的词性，正确率为:0.879429

第10轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20392个词的词性，正确率为:0.996969
开发集共有50319个词，预测正确了44265个词的词性，正确率为:0.879688

第11轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20393个词的词性，正确率为:0.997018
开发集共有50319个词，预测正确了44273个词的词性，正确率为:0.879847

第12轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20396个词的词性，正确率为:0.997164
开发集共有50319个词，预测正确了44278个词的词性，正确率为:0.879946

第13轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20396个词的词性，正确率为:0.997164
开发集共有50319个词，预测正确了44282个词的词性，正确率为:0.880025

第14轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20398个词的词性，正确率为:0.997262
开发集共有50319个词，预测正确了44285个词的词性，正确率为:0.880085

第15轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20398个词的词性，正确率为:0.997262
开发集共有50319个词，预测正确了44285个词的词性，正确率为:0.880085

第16轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20400个词的词性，正确率为:0.997360
开发集共有50319个词，预测正确了44283个词的词性，正确率为:0.880045

第17轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20401个词的词性，正确率为:0.997409
开发集共有50319个词，预测正确了44286个词的词性，正确率为:0.880105

第18轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20401个词的词性，正确率为:0.997409
开发集共有50319个词，预测正确了44287个词的词性，正确率为:0.880125

第19轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20401个词的词性，正确率为:0.997409
开发集共有50319个词，预测正确了44287个词的词性，正确率为:0.880125

第20轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20401个词的词性，正确率为:0.997409
开发集共有50319个词，预测正确了44287个词的词性，正确率为:0.880125

第21轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20401个词的词性，正确率为:0.997409
开发集共有50319个词，预测正确了44287个词的词性，正确率为:0.880125

第22轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20401个词的词性，正确率为:0.997409
开发集共有50319个词，预测正确了44287个词的词性，正确率为:0.880125

第23轮开始训练...
本轮训练完成，进行评估...
训练集共有20454个词，预测正确了20401个词的词性，正确率为:0.997409
开发集共有50319个词，预测正确了44287个词的词性，正确率为:0.880125
经过5轮模型正确率无提升，结束训练！最大正确率为第18轮训练后的0.880125
用时:0:02:52.167983
```

PS：大数据集会在服务器上跑一下，日后补上

### 学习过程中的笔记和思考

[NLP自学笔记：线性模型和对数线性模型](https://hillzhang1999.gitee.io/2020/03/17/nlp-zi-xue-bi-ji-xian-xing-mo-xing-he-dui-shu-xian-xing-mo-xing/)

### 参考资料（部分）

- [苏州大学李正华老师的课件](http://hlt.suda.edu.cn/~zhli/teach/cip-2015-fall/)
- 李航老师《统计学习方法》的第六章
- Andrew Ng的机器学习课程
- Andrew Ng的深度学习课程